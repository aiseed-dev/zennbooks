---
title: 第一章：始まりのデータと賢い相棒
---

高田美咲は、平日はWebデザイナーとしてモニターに向かい、週末はクライミングジムの壁に向かう生活を送っていた。チョークの匂い、ホールドを掴んだ時の指先の感触、そして何より、自分の限界を少しだけ超えられた瞬間の達成感が、彼女を夢中にさせていた。

「次の出張、札幌なんだ。近くにいいジムないかな…」

出張先や旅先でジムを探すのは、彼女にとっていつも悩みの種だった。情報はネットに散らばり、更新が止まったままの古いサイトや、スマホではレイアウトが崩れて読めないページも少なくない。

「全国のジム情報が、見やすくまとまったアプリがあれば最高なのに…」

そんなことをクライミング仲間の健太にこぼした数日後、彼から一通のメールが届いた。
「美咲さんが言ってたやつ、昔Excelでまとめたデータがあったから送るよ！何かの役に立つかも」

添付されていたのは、`climbing_gym_list.xlsx`というファイル。美咲はファイルを開き、無数のセルに並んだ文字列をスクロールしながら考えた。「これを、あのカラフルな壁のように、もっと直感的で、わくわくするものに変えられないだろうか？」

その瞬間、最近独学で始めたプログラミング言語「Flutter」と、仕事でも時々アイデア出しに使っているAIアシスタント「Gemini」のことが頭をよぎった。Flutterなら美しいアプリが作れる。そしてGeminiがいれば、きっと道に迷うことはないはずだ。

「…よし、作ってみよう。私のための、みんなのためのクライミングジム検索アプリを！」

決意した美咲は、さっそくGeminiに話しかけた。


**美咲:**
「Gemini、こんにちは！今、友だちからクライミングジムのリストが載ったExcelファイルをもらったんだ。これをFlutterアプリで使えるデータにしたいんだけど、何から始めたらいいかな？」

> **Gemini:**
> こんにちは、美咲さん！素晴らしいプロジェクトの始まりですね。お手伝いできて嬉しいです。
>
> Excelファイルをアプリで直接扱うのは少し複雑なので、まずは汎用的な**「JSON（ジェイソン）」形式**に変換するのがおすすめです。JSONは、Flutterをはじめ多くのプログラミング言語で簡単に読み込める、構造化されたテキストデータです。

**美咲:**
「JSON！聞いたことある。手作業で書き換えるのは大変そうだけど…」

> **Gemini:**
> その通りです。データが多ければ手作業は現実的ではありません。そこで、**Pythonスクリプトを使って自動で変換**しましょう。Pythonには`pandas`という、Excelのような表形式データを自在に操れる強力なライブラリがあります。

**美咲:**
「なるほど、Pythonで自動化か。具体的にはどういう手順になるの？」

> **Gemini:**
> はい、ステップはこうです。
> 1.  `pandas`でExcelファイルを読み込みます。
> 2.  Excelの日本語の列名を、アプリで使いやすい英語のキー名に変換します。例えば「ジム名」を`name`に、といった具合です。
> 3.  データの各行を、キーと値のペアを持つ「辞書」というデータ構造に変換します。
> 4.  全ての行の辞書を一つのリストにまとめ、それをJSONファイルとして書き出します。
>
> この手順で進めるためのスクリプトを作成しましょうか？

**美咲:**
「お願い！あと、英語のキー名を考えるのが苦手で…。何か良いルールはある？」

> **Gemini:**
> いい質問ですね。プログラミングの世界では、単語と単語の間をアンダースコア(`_`)でつなぐ**「スネークケース」**がよく使われます。例えば「電話番号」なら`phone_number`のように。これは可読性が高く、多くのプログラマーに好まれています。
>
> それと、Excelのセルが空欄の場合、データ上は`NaN`（非数）として扱われることがあります。これはJSONに変換する際にエラーの原因になるので、プログラム側で`null`（何もないことを示す値）に置き換える処理も加えておきましょう。

**美咲:**
「スネークケース、なるほど！`null`の処理も助かる。じゃあ、その内容でスクリプトをお願い！」

> **Gemini:**
> 承知しました。以下にPythonスクリプトを生成します。このスクリプトだけで試せるように、サンプル用のExcelファイルを自動で作成する機能も付けておきました。

---

#### **Geminiが生成したPythonスクリプト**

**準備:**
まず、必要なライブラリをインストールします。ターミナル（またはコマンドプロンプト）で以下のコマンドを実行してください。

```bash
pip install pandas openpyxl
```

**Pythonスクリプト (`convert_to_json.py`):**
```python
import pandas as pd
import json
import os
import numpy as np

# --- 設定項目 ---

# 健太からもらったExcelファイル名
INPUT_EXCEL_FILE = 'climbing_gym_list.xlsx'

# アプリで使うJSONファイル名
OUTPUT_JSON_FILE = 'gym_data_en.json'

# Excelの列名 (日本語) と JSONのキー (英語/スネークケース) の対応表
# Geminiが提案し、美咲が確認したマッピング
COLUMN_MAPPING = {
    'ID': 'id',
    '地方': 'region',
    '都道府県': 'prefecture',
    '市区町村': 'city',
    '住所': 'address',
    'アクセス': 'access',
    'ジム名': 'name',
    'ウェブサイト': 'website',
    '電話番号': 'phone_number',
    '壁面積(㎡)': 'wall_area',
    '壁の高さ(m)': 'wall_height',
    '駐車場': 'has_parking',
    'シャワー': 'has_shower',
    'ショップ': 'has_shop',
    '備考': 'notes'
}

def create_dummy_excel():
    """
    このスクリプトを単体で試せるように、見本のExcelファイルを作成する関数。
    美咲が健太からもらったファイルを想定しています。
    """
    if os.path.exists(INPUT_EXCEL_FILE):
        print(f"'{INPUT_EXCEL_FILE}' は既に存在します。作成をスキップします。")
        return

    print(f"見本ファイル '{INPUT_EXCEL_FILE}' を作成します...")
    # サンプルデータを作成
    sample_data = [
        {
            'ID': 1, '地方': '北海道', '都道府県': '北海道', '市区町村': '札幌市白石区',
            '住所': '北海道札幌市白石区東札幌3条2丁目1-7', 'アクセス': '地下鉄東西線「東札幌」駅より徒歩3分',
            'ジム名': 'NAC札幌クライミングジム', 'ウェブサイト': 'https://www.nacadventures.jp/nac-sapporo',
            '電話番号': '011-812-7979', '壁面積(㎡)': np.nan, '壁の高さ(m)': 10,
            '駐車場': '有', 'シャワー': '無', 'ショップ': '有', '備考': ''
        },
        {
            'ID': 2, '地方': '関東', '都道府県': '埼玉県', '市区町村': '入間市',
            '住所': '埼玉県入間市東町7-1-7', 'アクセス': '圏央道「入間IC」から約10分',
            'ジム名': 'Climb Park Base Camp', 'ウェブサイト': 'https://b-camp.jp/iruma/',
            '電話番号': '04-2936-8585', '壁面積(㎡)': 1200, '壁の高さ(m)': 15,
            '駐車場': '有', 'シャワー': '有', 'ショップ': '有', '備考': '日本最大級のクライミングジム'
        },
        {
            'ID': 3, '地方': '近畿', '都道府県': '大阪府', '市区町村': '大阪市北区',
            '住所': '大阪府大阪市北区長柄西1-5-21', 'アクセス': '天神橋筋六丁目駅から徒歩5分',
            'ジム名': 'Climbing JAM', 'ウェブサイト': 'http://climbing-jam.com/',
            '電話番号': '06-6467-4977', '壁面積(㎡)': np.nan, '壁の高さ(m)': np.nan,
            '駐車場': '無', 'シャワー': None, 'ショップ': '有', '備考': '2023年に閉店'
        },
    ]
    df = pd.DataFrame(sample_data)
    df.to_excel(INPUT_EXCEL_FILE, index=False)
    print("見本ファイルの作成が完了しました。")


def convert_excel_to_json():
    """
    Excelファイルを読み込み、JSON形式に変換して出力するメインの関数。
    """
    try:
        print(f"'{INPUT_EXCEL_FILE}' を読み込んでいます...")
        df = pd.read_excel(INPUT_EXCEL_FILE)
        
        # 空のセル(NaN)をJSONで扱えるNone(null)に変換
        df = df.astype(object).where(pd.notnull(df), None)

        # 列名を日本語から英語に変換
        df.rename(columns=COLUMN_MAPPING, inplace=True)
        
        # マッピングに存在する列のみを選択
        df = df[list(COLUMN_MAPPING.values())]

        # DataFrameを辞書のリストに変換
        data_list = df.to_dict(orient='records')
        
        print(f"'{OUTPUT_JSON_FILE}' を作成しています...")
        with open(OUTPUT_JSON_FILE, 'w', encoding='utf-8') as f:
            # ensure_ascii=False で日本語の文字化けを防ぎ, indent=4 で見やすくフォーマット
            json.dump(data_list, f, ensure_ascii=False, indent=4)
            
        print("-" * 30)
        print(f"🎉 変換が成功しました！ '{OUTPUT_JSON_FILE}' を確認してください。")
        print("-" * 30)

    except FileNotFoundError:
        print(f"エラー: 入力ファイル '{INPUT_EXCEL_FILE}' が見つかりませんでした。")
    except Exception as e:
        print(f"エラーが発生しました: {e}")


if __name__ == "__main__":
    create_dummy_excel()
    print("-" * 30)
    convert_excel_to_json()
```

---

美咲は言われた通りにスクリプトを実行した。すると、コマンドラインに成功のメッセージが表示され、フォルダには`gym_data_en.json`という新しいファイルが生まれていた。

```json
// gym_data_en.json
[
    {
        "id": 1,
        "region": "北海道",
        "prefecture": "北海道",
        "city": "札幌市白石区",
        "address": "北海道札幌市白石区東札幌3条2丁目1-7",
        "access": "地下鉄東西線「東札幌」駅より徒歩3分",
        "name": "NAC札幌クライミングジム",
        "website": "https://www.nacadventures.jp/nac-sapporo",
        "phone_number": "011-812-7979",
        "wall_area": null,
        "wall_height": 10.0,
        "has_parking": "有",
        "has_shower": "無",
        "has_shop": "有",
        "notes": ""
    },
    // ... (以下続く)
]
```

「すごい…！本当に一瞬で変換できた！」

無機質なExcelのセルが、規則正しく構造化された美しいテキストデータに生まれ変わった。それは、アプリ開発という名の巨大な壁に、最初のホールドを打ち込んだような感覚だった。

「Geminiと一緒なら、本当にこのアプリ、完成させられるかもしれない！」

美咲の胸に、確かな手応えと希望の光が灯った。これが、彼女と賢い相棒のプロジェクトの、記念すべき第一歩だった。
