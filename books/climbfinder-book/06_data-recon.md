---
title: 第六章：不完全なデータという名の核心（ルビ：コア）
---

アプリの基本的な機能が完成し、美咲は達成感に満たされていた。出張先の札幌で、実際に自分の作ったアプリを使ってジムを探し、登りに行く。その体験は格別だった。

しかし、アプリを使い込むうちに、彼女は元データの「不完全さ」に気づき始める。

「あれ、このジム、ウェブサイトの情報が古いな…」
「こっちのジムは、電話番号が`null`になってる。もらったExcelの時点で空欄だったんだ…」

一番気になったのは、クライマー仲間と話しているときだった。
「美咲ちゃんのアプリ便利だね！でもさ、このジム、オートビレイ（自動でロープを巻き取ってくれる安全装置）あるのかな？リード壁（ロープクライミング用の高い壁）があるかどうかとか、そういう情報が一番知りたいんだよね」

美咲はハッとした。健太からもらった`climbing_gym_list.xlsx`には、そんな項目はそもそも存在しなかったのだ。彼女が最初に作った`gym_data_en.json`は、いわば不完全な設計図だった。

このままでは、ユーザーが本当に欲しい情報を提供できない。この問題をどう乗り越えるか。美咲はキーボードに向かい、Geminiに語りかけた。

---

**美咲:**
「Gemini、問題が見えてきたよ。私が使ってる`gym_data_en.json`には、情報が古かったり、そもそも項目が足りなかったりする。『オートビレイの有無』とか『リード壁の有無』みたいな、クライマーが本当に知りたい情報が入ってないんだ。」

> **Gemini:**
> 美咲さん、それはどんなアプリ開発でも必ず直面する「データの壁」ですね。静的なデータソースに依存していると、情報の鮮度と網羅性に限界が出てきます。素晴らしいのは、それに気づき、改善しようとしていることです。

**美咲:**
「この`gym_data_en.json`を私が手で修正し続けるのは、現実的じゃないよね…？何かいい方法はないかな。」

> **Gemini:**
> その通りです。美咲さん一人の力で全国のジムの最新情報を追い続けるのは不可能です。ここで発想を転換しましょう。**「ユーザーみんなで情報を育てていく」**というアプローチはいかがでしょうか？

**美咲:**
「みんなで育てる…？面白そう！具体的にはどうやるの？」

> **Gemini:**
> はい。そのために強力な味方となるのが、**Firebase**というプラットフォームです。特に、その中にある**Cloud Firestore**というデータベースを使います。

**美咲:**
「Firebase…！名前は聞いたことある。難しそう…。」

> **Gemini:**
> 大丈夫ですよ、一歩ずつ進めば怖くありません。Cloud Firestoreは、一言で言うと「リアルタイムで読み書きできる、クラウド上のデータベース」です。
>
> これを使うと、例えば以下のようなことが可能になります。
> 1.  アプリのユーザーが「このジムにはオートビレイがあります」という情報を投稿する。
> 2.  その情報がCloud Firestoreに保存される。
> 3.  他のユーザーが同じジムのページを開くと、その投稿がリアルタイムで表示される。
>
> こうすれば、静的なJSONファイルに頼らず、ユーザーの善意で情報がどんどんリッチになっていく「生きたアプリ」を作ることができるんです。

**美咲:**
「すごい！まさに私がやりたかったことだよ！でも、既存のJSONデータはどうなるの？全部Firebaseに移し替えるの？」

> **Gemini:**
> いいえ、その必要はありません。ハイブリッドなアプローチが効果的です。
> *   **基本情報（ジム名、住所など）:** 変更の少ないこれらの情報は、引き続き`gym_data_en.json`から読み込みます。これはアプリの起動を速く保つためです。
> *   **追加情報（設備、コメントなど）:** ユーザーが更新・投稿するこれらの動的な情報は、Cloud Firestoreで管理します。
>
> この二つを組み合わせることで、パフォーマンスと情報の鮮度を両立できます。まずは、この「みんなで育てる」仕組みの第一歩として、**各ジムにユーザーがコメントを投稿できる機能**を追加してみませんか？

**美咲:**
「コメント機能！それなら『オートビレイありますよ！』とか『ここの課題面白い！』みたいな生きた情報を共有できるね。ぜひやりたい！何から始めればいい？」

> **Gemini:**
> 素晴らしい決意です！最初のステップは、Firebaseプロジェクトのセットアップです。
> 1.  Firebaseの公式サイトでプロジェクトを作成します。
> 2.  作成したプロジェクトを、美咲さんのFlutterアプリに接続します（設定ファイルをダウンロードしてプロジェクトに追加するだけです）。
> 3.  FlutterでFirebaseを使うためのパッケージ（`firebase_core`や`cloud_firestore`）を`pubspec.yaml`に追加します。
>
> この初期設定は少し手順が多いですが、公式ドキュメントやガイドが充実しています。一緒に確認しながら進めましょう。

---

美咲は、Geminiに導かれるようにしてFirebaseのセットアップを進めていった。最初は見慣れない画面や専門用語に戸惑ったが、一つ一つの手順をクリアしていく感覚は、クライミングのムーブを解決していくのに似ていた。

`pubspec.yaml`に新しい依存関係が追加される。

```yaml
# pubspec.yaml
dependencies:
  flutter:
    sdk: flutter
  url_launcher: ^6.1.14

  # Firebase関連のパッケージを追加
  firebase_core: ^2.24.2     # Firebaseを初期化するために必須
  cloud_firestore: ^4.14.0 # Firestoreデータベースを使うため
```

そして、アプリ起動時にFirebaseを初期化するためのコードを`main.dart`に書き加えた。

```dart
// lib/main.dart
import 'package:flutter/material.dart';
import 'screens/home_screen.dart';
import 'package:firebase_core/firebase_core.dart'; // インポート
import 'firebase_options.dart'; // Firebase CLIで自動生成されるファイル

void main() async {
  // Flutterアプリの実行前に、ウィジェットのバインディングを確実に行う
  WidgetsFlutterBinding.ensureInitialized();
  // Firebaseを初期化する
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  // ... (以下は変更なし)
}
```

これは、UIに直接的な変化をもたらすものではない。しかし美咲は、自分のアプリが今、ローカルなJSONファイルという閉じた世界から、クラウド上の広大なデータベースへと接続されたことを確かに感じていた。

不完全なデータという「核心（コア）」。それを乗り越えるためのルートは、自分一人でデータを完璧にすることではなかった。ユーザーみんなの力を借りて、共にアプリを育てていくこと。そのための強力なホールド、Firebaseを手に入れた美咲の挑戦は、新たなフェーズへと突入した。